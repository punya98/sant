<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sant Valves – Quotation Calculator | Vijay Sales Corporation</title>

<style>
  :root{ --brand:#24364e; }
  body{font-family:Arial,Helvetica,sans-serif;background:#f7f8fb;color:#333;margin:0}
  header{background:var(--brand);color:#fff;padding:10px 14px;text-align:center;font-weight:700}
  main{max-width:980px;margin:24px auto;padding:0 16px}
  h1{color:var(--brand);margin:6px 0 14px}

  .card{background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:16px;margin:14px 0;width:100%;display:block}
  label{display:block;margin:10px 0 6px;font-weight:600}
  select,input{width:100%;padding:10px;border:1px solid #ccd1d9;border-radius:6px;background:#fff;min-height:44px}

  .row{display:grid;gap:12px}
  @media(min-width:720px){
    .row.cols-2{grid-template-columns:1fr 1fr}
    .row.cols-3{grid-template-columns:1fr 1fr 1fr}
    .row.cols-4{grid-template-columns:1fr 1fr 1fr 1fr}
  }

  .btn{background:var(--brand);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#fff;color:var(--brand);border:2px solid var(--brand)}
  .btn:disabled{opacity:.6;cursor:not-allowed}

  table{width:100%;border-collapse:collapse;margin-top:10px}
  #quoteTable{width:100%;table-layout:auto;min-width:760px}
  th,td{border:1px solid #e3e6eb;padding:10px;text-align:center}
  th{background:var(--brand);color:#fff}
  tfoot td{font-weight:700}

  .flex{display:flex;gap:10px;flex-wrap:wrap}
  .right{justify-content:flex-end}
  .divider{border:0;border-top:1px solid #e3e6eb;margin:16px 0}
  .powered-by{display:block;width:100%;text-align:center;margin:16px 0 0;clear:both;color:#555;font-size:14px}

  /* Ensure blocks stack inside grids */
  .card .table-responsive,
  .card .divider,
  .card .flex.right{grid-column:1 / -1; width:100%; float:none; clear:both; display:block}
  .card .flex.right{display:flex; justify-content:flex-end; gap:10px; flex-wrap:wrap; margin-top:14px}

  /* Mobile card view */
  @media (max-width:640px){
    main{padding:0 12px}
    h1{font-size:clamp(20px,5.5vw,26px)}
    label{font-size:14px}
    th,td{padding:8px 6px;font-size:13px}

    #quoteTable{min-width:0; border-collapse:separate; border-spacing:0 12px}
    #quoteTable thead{display:none}

    #quoteTable tbody tr{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:8px;
      background:#fff;
      border:1px solid #e3e6eb;
      border-radius:8px;
      padding:12px;
    }
    #quoteTable tbody td{
      border:none;
      padding:0;
      font-size:14px;
      text-align:left;
      background:#fff;
    }

    /* Auto labels (match column order below) */
    #quoteTable tbody td:nth-child(1)::before{content:"Product: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(2)::before{content:"Size (NB): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(3)::before{content:"Unit Price (₹): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(4)::before{content:"Qty: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(5)::before{content:"Line Total (₹): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(6)::before{content:"Remove: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}

    #quoteTable tbody td:nth-child(6){
      grid-column:1 / -1;
      justify-self:end;
    }

    #quoteTable tfoot tr{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:8px;
      background:#fff;
      border:1px solid #e3e6eb;
      border-radius:8px;
      padding:12px;
    }
    #quoteTable tfoot td{border:none;padding:0;font-size:14px;text-align:left}
    #quoteTable tfoot td[colspan]{grid-column:1;text-align:left}
    #quoteTable tfoot td[id]{grid-column:2;text-align:right}
    #quoteTable tfoot td:last-child{display:none}

    .row{grid-template-columns:1fr !important}
    .card .flex.right{justify-content:stretch; flex-direction:column}
    .card .flex.right .btn{width:100%}
    .powered-by{font-size:13px;margin:12px 0 0}
  }
</style>

<!-- jsPDF + AutoTable -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
<header>
  Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008
</header>

<main>
  <h1> Sant Valves – Live Quote </h1>

  <div class="card">
    <div class="row cols-4">
      <div>
        <label for="category">Product</label>
        <select id="category"></select>
      </div>
      <div>
        <label for="size">Size (NB)</label>
        <select id="size"></select>
      </div>
      <div>
        <label for="qty">Quantity (pcs)</label>
        <input type="number" id="qty" value="1" min="1"/>
      </div>
      <div>
        <label for="unitPrice">List Price / pc (₹)</label>
        <input type="text" id="unitPrice" readonly/>
      </div>
      <div>
        <label for="discount">Discount (%)</label>
        <input type="number" id="discount" value="48" readonly />
      </div>
      <div>
        <label>&nbsp;</label>
        <button class="btn" onclick="addItem()">Add to Quotation</button>
      </div>
    </div>
  </div>

  <div class="card">
    <h2 style="margin:0 0 10px">Quotation Summary</h2>
    <div class="table-responsive">
      <table id="quoteTable">
        <thead>
          <tr>
            <th>Product</th>
            <th>Size (NB)</th>
            <th>Unit Price (₹)</th>
            <th>Qty</th>
            <th>Line Total (₹)</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr>
            <td colspan="4" style="text-align:right">Sub-Total</td>
            <td id="subTotal">₹0</td>
            <td></td>
          </tr>
          <tr>
            <td colspan="4" style="text-align:right">GST (18%)</td>
            <td id="gstAmt">₹0</td>
            <td></td>
          </tr>
          <tr>
            <td colspan="4" style="text-align:right"><strong>Grand Total</strong></td>
            <td id="grandTotal">₹0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <hr class="divider">

    <div class="flex right" style="margin-top:14px">
      <button class="btn" onclick="downloadPDF()">Download PDF</button>
      <button class="btn secondary" onclick="sendWA()">Send via WhatsApp</button>
      <button class="btn secondary" onclick="resetAll()">Reset</button>
    </div>
  </div>

  <p class="powered-by">
    ⚡ Powered by <strong>Vijay Sales Corporation</strong> – India’s Piping Experts since 1961.
  </p>
</main>

<script>
/* ---- PRICE DATA (₹/pc) — Sant Valves price list (10.06.2024) ---- */
const SANT_DATA = {
 "Forged Brass Ball Valve Threaded PN25 (FBV-2)": {
    prices: {
        "8": 539,
        "10": 539,
        "15": 605,
        "20": 859,
        "25": 1327,
        "32": 2295,
        "40": 3431,
        "50": 4769,
        "65": 10207,
        "80": 14908,
        "100": 27608
    }
},
 "CI Butterfly Valve PN1.6 with SG Iron Disc (CR21A/BFX)": {
  prices: {"40":2840,"50":3246,"65":3516,"80":3780,"100":4861,"125":6244,"150":7179,"200":14854,"250":23282,"300":27792}
},

"CI Butterfly Valve PN16 with SS-304 Disc (BFY)": {
  prices: {"50":3512,"65":3855,"80":4682,"100":5791,"125":7791,"150":8812,"200":18516}
},

"CI Butterfly Valve PN10 with SG Iron Disc (CR-23)": {
  prices: {"40":2192,"50":2459,"65":2698,"80":2976,"100":3881,"125":5409,"150":6125,"200":10459,"250":15413,"300":19297}
},

"CI Y Strainer Flanged End Epoxy Coated with SS Screen (CI16B)": {
  prices: {"25":1935,"32":2394,"40":3403,"50":4647,"65":6617,"80":8590,"100":12844,"125":20341,"150":26159,"200":49055,"250":69343}
},

"CI Dual Plate NRV PN1.6 (DP)": {
  prices: {"50":4028,"65":4459,"80":5871,"100":7451,"125":8921,"150":11333,"200":21096,"250":31049}
},

"Cast Iron Reflux Valve PN16, IS:5312 (CR-31A)": {
  prices: {"50":5387,"65":6620,"80":8493,"100":11326,"125":19651,"150":22714,"200":40584,"250":67426,"300":89116}
},

"Single Plate NRV PN16 (SP)": {
  prices: {"50":1985,"65":2190,"80":2869,"100":3689,"150":6612,"200":10337,"250":13316,"300":19364,"350":33075,"400":45320}
},

"D.I. Balancing Valve Flanged (CIBV)": {
  prices: {"65":16099,"80":18917,"100":28235,"125":40108,"150":54378,"200":93316,"250":150329,"300":179113}
},

"Brass Balancing Valve (SBBV)": {
  prices: {"20":3017,"25":3976,"32":4980,"40":6268,"50":9162}
},

"CI Gate Sluice Valve Flanged PN1.6 'ISI' (CR32B)": {
  prices: {"50":10359,"65":14150,"80":15996,"100":24432,"125":28073,"150":31707,"200":50408,"250":81774,"300":95480}
},

"CI Ball Valve Threaded 'ISI' (CI-17)": {
  prices: {"15":564,"20":845,"25":999,"32":1655,"40":2157,"50":3083,"65":5931,"80":8706,"100":20717}
},

"CI Ball Valve Flanged 'ISI' (CI-18)": {
  prices: {"25":2157,"32":2997,"40":3838,"50":5940,"65":8946,"80":12794,"100":24543}
},

"C.S. Ball Valve Flanged Class 150 Three Piece Design (CS-11)": {
  prices: {"25":4491,"40":8048,"50":10781,"65":15379,"80":19523,"100":31329}
},

"C.S. Ball Valve Threaded (WCB)": {
  prices: {"15":1784,"20":2114,"25":2964,"32":4301,"40":5835,"50":7143}
},

"CI Ball Foot Valve (BFV)": {
  prices: {"50":3552,"65":4696,"80":6092,"100":9672,"150":20310,"200":48742}
},

"CI Globe Valve (CI-1A)": {
  prices: {"15":3183,"20":3469,"25":3869,"32":5627,"40":7071,"50":8979,"65":13182,"80":16914,"100":23139,"150":33992,"200":45708}
}


/* ---- UI Elements ---- */
const $cat = document.getElementById('category');
const $size = document.getElementById('size');
const $qty  = document.getElementById('qty');
const $unit = document.getElementById('unitPrice');
const $tbody= document.querySelector('#quoteTable tbody');
const $sub   = document.getElementById('subTotal');
const $gstAmt= document.getElementById('gstAmt');
const $grand = document.getElementById('grandTotal');
const $disc  = document.getElementById('discount');

let rows = [];

/* ---- Init ---- */
(function init(){
  Object.keys(SANT_DATA).forEach(k=>{
    const opt = document.createElement('option');
    opt.value = k; opt.textContent = k;
    $cat.appendChild(opt);
  });
  onCategory();
})();

$cat.addEventListener('change', onCategory);
$size.addEventListener('change', updateUnitPrice);

function onCategory(){
  $size.innerHTML = '';
  const group = SANT_DATA[$cat.value];
  const sizes = Object.keys(group.prices)
    .sort((a,b)=>parseInt(a,10)-parseInt(b,10));
  sizes.forEach(s=>{
    const o = document.createElement('option');
    o.value = s; o.textContent = s;
    $size.appendChild(o);
  });
  if(sizes.length){ $size.value = sizes[0]; }
  updateUnitPrice();
}

function updateUnitPrice(){
  const cat = $cat.value;
  const sizeKey = $size.value;
  const price = SANT_DATA[cat].prices[sizeKey];
  $unit.value = price ? price.toLocaleString('en-IN') : '';
}

function addItem(){
  const cat = $cat.value;
  const size = $size.value;
  const qty  = Math.max(1, parseInt($qty.value||'1',10));
  const unitList = SANT_DATA[cat].prices[size];
  if(!unitList) return alert('Invalid selection');

  const discountPct = parseFloat($disc.value)||0; // fixed 48
  const unitAfterDisc = unitList * (1 - discountPct/100);
  const line = unitAfterDisc * qty;

  const row = {cat, size, unitList, discountPct, qty, total: line};
  rows.push(row);
  renderRows();
  $qty.value = 1;
}

function renderRows(){
  $tbody.innerHTML = '';
  rows.forEach((r,idx)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${r.cat}</td>
      <td>${r.size}</td>
      <td>₹${(r.unitList*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
      <td>${r.qty}</td>
      <td>₹${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
      <td><button class="btn secondary" onclick="removeRow(${idx})">X</button></td>
    `;
    $tbody.appendChild(tr);
  });
  recalc();
}

function removeRow(i){
  rows.splice(i,1);
  renderRows();
}

function recalc(){
  const sub = rows.reduce((a,b)=>a + b.total, 0);
  const gst = +(sub * 0.18).toFixed(2);
  const grand = sub + gst;

  $sub.textContent    = "₹" + sub.toLocaleString('en-IN',{maximumFractionDigits:2});
  $gstAmt.textContent = "₹" + gst.toLocaleString('en-IN',{maximumFractionDigits:2});
  $grand.textContent  = "₹" + grand.toLocaleString('en-IN',{maximumFractionDigits:2});
}

function resetAll(){
  rows = [];
  renderRows();
  recalc();
}

/* ---- PDF ---- */
function downloadPDF(){
  recalc();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(14);
  doc.text('Sant Valves – Quotation', 14, 14);
  doc.setFontSize(10);
  doc.text('Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008',14,20);

  const body = rows.length? rows.map(r=>[
    r.cat, r.size,
    `INR ${(r.unitList*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}`,
    r.qty, `INR ${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}`
  ]) : [['-','-','-','-','-']];

  doc.autoTable({
    startY: 26,
    head: [['Product','Size (NB)','Unit (INR)','Qty','Line Total (INR)']],
    body
  });

  const y = (doc.lastAutoTable?.finalY || 26) + 8;
  const sub = rows.reduce((a,b)=>a+b.total, 0);
  const gst = +(sub * 0.18).toFixed(2);
  const grand = sub + gst;

  doc.setFontSize(11);
  doc.text(`Sub-Total: INR ${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y);
  doc.text(`GST (18%): INR ${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+6);
  doc.setFont(undefined,'bold');
  doc.text(`Grand Total: INR ${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+14);
  doc.setFont(undefined,'normal');
  doc.setFontSize(9);
  doc.text('Notes: Rates are EX Delhi; Cartage & Freight extra as per actual. GST @ 18% extra. Price list at dispatch applies.', 14, y+22);

  doc.save('Sant-Valves-Quotation.pdf');
}

/* ---- WhatsApp ---- */
function sendWA(){
  recalc();
  let msg = 'Sant Valves Quotation – Vijay Sales Corporation\n\n';
  if(!rows.length){ msg += '(No items added)\n'; }
  rows.forEach(r=>{
    msg += `• ${r.cat} | ${r.size} NB | Qty ${r.qty} | Unit ₹${(r.unitList*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})} | Line ₹${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}\n`;
  });
  const sub = rows.reduce((a,b)=>a+b.total, 0);
  const gst = +(sub * 0.18).toFixed(2);
  const grand = sub + gst;

  msg += `\nSub-Total: ₹${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
  msg += `\nGST (18%): ₹${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
  msg += `\nGrand Total: ₹${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}\n\n`;
  msg += `Contact: 9999889008 • sales@vijaysalescorp.com`;

  const url = `https://wa.me/919999889008?text=${encodeURIComponent(msg)}`;
  window.open(url,'_blank');
}
</script>
</body>
</html>
